PV = "0.1cvs${CVSDATE}"
PR = "r2"

DESCRIPTION = "tslib is a touchscreen access library."

CONFFILES_${PN} = "${sysconfdir}/ts.conf"

SRC_URI = "cvs://anoncvs:anoncvs@cvs.handhelds.org/cvs;module=apps/tslib \
           file://collie/ts.conf \
           file://collie/tslib.sh \
           file://corgi/ts.conf \
           file://corgi/tslib.sh \
           file://h3600/ts.conf \
           file://h3600/tslib.sh \
           file://husky/ts.conf \
           file://husky/tslib.sh \
           file://poodle/ts.conf \
           file://poodle/tslib.sh \
	   file://simpad/ts.conf \
	   file://simpad/tslib.sh \
           file://shepherd/ts.conf \
           file://shepherd/tslib.sh"
S = "${WORKDIR}/tslib"

inherit autotools

EXTRA_OECONF = "--enable-shared"

do_stage () {
	oe_libinstall -so -C src libts-0.0 ${STAGING_LIBDIR}
	ln -sf libts-0.0.so ${STAGING_LIBDIR}/libts.so
	install -m 0644 src/tslib.h ${STAGING_INCDIR}/
	install -m 0644 src/tslib-private.h ${STAGING_INCDIR}/
}

do_install_prepend () {
	oe_machinstall -m 0644 ${WORKDIR}/ts.conf ${S}/etc/ts.conf
}

do_install_append() {
	install -d ${D}/${sysconfdir}/profile.d/
	oe_machinstall -m 0755 ${WORKDIR}/tslib.sh ${D}/${sysconfdir}/profile.d/
}

FILES_${PN} += " ${libdir}/ts/*.so ${datadir}/ts/plugins/*.so"

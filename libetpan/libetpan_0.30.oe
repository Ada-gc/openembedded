DEPENDS = virtual/libc db3 openssl
RDEPENDS = libc6 db3 openssl

SRC_URI = ${SOURCEFORGE_MIRROR}/libetpan/libetpan-${PV}.tar.gz \
	  file://${FILESDIR}/limits.patch;patch=1 \
	  file://${FILESDIR}/install.patch;patch=1

inherit autotools libtool

EXTRA_OECONF = '--with-openssl=${STAGING_LIBDIR}/.. \
		--without-libiconv-prefix'

do_stage () {
	install -m 0644 .libs/libetpan.lai ${STAGING_LIBDIR}/libetpan.la
	install -m 0644 .libs/libetpan.a ${STAGING_LIBDIR}/libetpan.a
	install -m 0755 .libs/libetpan.so.0.0.0 ${STAGING_LIBDIR}/
	ln -sf libetpan.so.0.0.0 ${STAGING_LIBDIR}/libetpan.so.0
	ln -sf libetpan.so.0.0.0 ${STAGING_LIBDIR}/libetpan.so
	install -d ${STAGING_DIR}/target/include/libetpan
	install -m 0644 imap/mailimap_helper.h ${STAGING_DIR}/target/include/libetpan/mailimap_helper.h
	install -m 0644 imap/mailimap.h ${STAGING_DIR}/target/include/libetpan/mailimap.h
	install -m 0644 imap/mailimap_types.h ${STAGING_DIR}/target/include/libetpan/mailimap_types.h
	install -m 0644 imap/mailimap_types_helper.h ${STAGING_DIR}/target/include/libetpan/mailimap_types_helper.h
	install -m 0644 imap/mailimap_socket.h ${STAGING_DIR}/target/include/libetpan/mailimap_socket.h
	install -m 0644 imap/mailimap_ssl.h ${STAGING_DIR}/target/include/libetpan/mailimap_ssl.h
	install -m 0644 nntp/newsnntp.h ${STAGING_DIR}/target/include/libetpan/newsnntp.h
	install -m 0644 nntp/newsnntp_socket.h ${STAGING_DIR}/target/include/libetpan/newsnntp_socket.h
	install -m 0644 nntp/newsnntp_ssl.h ${STAGING_DIR}/target/include/libetpan/newsnntp_ssl.h
	install -m 0644 nntp/newsnntp_types.h ${STAGING_DIR}/target/include/libetpan/newsnntp_types.h
	install -m 0644 pop3/mailpop3.h ${STAGING_DIR}/target/include/libetpan/mailpop3.h
	install -m 0644 pop3/mailpop3_socket.h ${STAGING_DIR}/target/include/libetpan/mailpop3_socket.h
	install -m 0644 pop3/mailpop3_helper.h ${STAGING_DIR}/target/include/libetpan/mailpop3_helper.h
	install -m 0644 pop3/mailpop3_ssl.h ${STAGING_DIR}/target/include/libetpan/mailpop3_ssl.h
	install -m 0644 pop3/mailpop3_types.h ${STAGING_DIR}/target/include/libetpan/mailpop3_types.h
	install -m 0644 smtp/mailsmtp.h ${STAGING_DIR}/target/include/libetpan/mailsmtp.h
	install -m 0644 smtp/mailsmtp_helper.h ${STAGING_DIR}/target/include/libetpan/mailsmtp_helper.h
	install -m 0644 smtp/mailsmtp_socket.h ${STAGING_DIR}/target/include/libetpan/mailsmtp_socket.h
	install -m 0644 smtp/mailsmtp_ssl.h ${STAGING_DIR}/target/include/libetpan/mailsmtp_ssl.h
	install -m 0644 smtp/mailsmtp_types.h ${STAGING_DIR}/target/include/libetpan/mailsmtp_types.h
	install -m 0644 tools/mailstream.h ${STAGING_DIR}/target/include/libetpan/mailstream.h
	install -m 0644 tools/mailstream_helper.h ${STAGING_DIR}/target/include/libetpan/mailstream_helper.h
	install -m 0644 tools/mail.h ${STAGING_DIR}/target/include/libetpan/mail.h
	install -m 0644 tools/mmapstring.h ${STAGING_DIR}/target/include/libetpan/mmapstring.h
	install -m 0644 tools/mailstream_low.h ${STAGING_DIR}/target/include/libetpan/mailstream_low.h
	install -m 0644 tools/mailstream_socket.h ${STAGING_DIR}/target/include/libetpan/mailstream_socket.h
	install -m 0644 tools/mailstream_ssl.h ${STAGING_DIR}/target/include/libetpan/mailstream_ssl.h
	install -m 0644 tools/mailstream_types.h ${STAGING_DIR}/target/include/libetpan/mailstream_types.h
	install -m 0644 tools/carray.h ${STAGING_DIR}/target/include/libetpan/carray.h
	install -m 0644 tools/clist.h ${STAGING_DIR}/target/include/libetpan/clist.h
	install -m 0644 tools/chash.h ${STAGING_DIR}/target/include/libetpan/chash.h
	install -m 0644 tools/cinthash.h ${STAGING_DIR}/target/include/libetpan/cinthash.h
	install -m 0644 tools/charconv.h ${STAGING_DIR}/target/include/libetpan/charconv.h
	install -m 0644 tools/mail_cache_db_types.h ${STAGING_DIR}/target/include/libetpan/mail_cache_db_types.h
	install -m 0644 imf/mailimf.h ${STAGING_DIR}/target/include/libetpan/mailimf.h
	install -m 0644 imf/mailimf_types.h ${STAGING_DIR}/target/include/libetpan/mailimf_types.h
	install -m 0644 imf/mailimf_write.h ${STAGING_DIR}/target/include/libetpan/mailimf_write.h
	install -m 0644 imf/mailimf_types_helper.h ${STAGING_DIR}/target/include/libetpan/mailimf_types_helper.h
	install -m 0644 mbox/mailmbox.h ${STAGING_DIR}/target/include/libetpan/mailmbox.h
	install -m 0644 mbox/mailmbox_types.h ${STAGING_DIR}/target/include/libetpan/mailmbox_types.h
	install -m 0644 mh/mailmh.h ${STAGING_DIR}/target/include/libetpan/mailmh.h
	install -m 0644 maildir/maildir.h ${STAGING_DIR}/target/include/libetpan/maildir.h
	install -m 0644 maildir/maildir_types.h ${STAGING_DIR}/target/include/libetpan/maildir_types.h
	install -m 0644 mime/mailmime.h ${STAGING_DIR}/target/include/libetpan/mailmime.h
	install -m 0644 mime/mailmime_types.h ${STAGING_DIR}/target/include/libetpan/mailmime_types.h
	install -m 0644 mime/mailmime_content.h ${STAGING_DIR}/target/include/libetpan/mailmime_content.h
	install -m 0644 mime/mailmime_decode.h ${STAGING_DIR}/target/include/libetpan/mailmime_decode.h
	install -m 0644 mime/mailmime_disposition.h ${STAGING_DIR}/target/include/libetpan/mailmime_disposition.h
	install -m 0644 mime/mailmime_write.h ${STAGING_DIR}/target/include/libetpan/mailmime_write.h
	install -m 0644 mime/mailmime_types_helper.h ${STAGING_DIR}/target/include/libetpan/mailmime_types_helper.h
	install -m 0644 generic/libetpan_version.h ${STAGING_DIR}/target/include/libetpan/libetpan_version.h
	install -m 0644 generic/maildriver.h ${STAGING_DIR}/target/include/libetpan/maildriver.h
	install -m 0644 generic/maildriver_types.h ${STAGING_DIR}/target/include/libetpan/maildriver_types.h
	install -m 0644 generic/maildriver_types_helper.h ${STAGING_DIR}/target/include/libetpan/maildriver_types_helper.h
	install -m 0644 generic/imapdriver.h ${STAGING_DIR}/target/include/libetpan/imapdriver.h
	install -m 0644 generic/imapdriver_cached.h ${STAGING_DIR}/target/include/libetpan/imapdriver_cached.h
	install -m 0644 generic/imapdriver_message.h ${STAGING_DIR}/target/include/libetpan/imapdriver_message.h
	install -m 0644 generic/imapdriver_cached_message.h ${STAGING_DIR}/target/include/libetpan/imapdriver_cached_message.h
	install -m 0644 generic/imapstorage.h ${STAGING_DIR}/target/include/libetpan/imapstorage.h
	install -m 0644 generic/imapdriver_types.h ${STAGING_DIR}/target/include/libetpan/imapdriver_types.h
	install -m 0644 generic/generic_cache_types.h ${STAGING_DIR}/target/include/libetpan/generic_cache_types.h
	install -m 0644 generic/nntpdriver.h ${STAGING_DIR}/target/include/libetpan/nntpdriver.h
	install -m 0644 generic/nntpdriver_cached.h ${STAGING_DIR}/target/include/libetpan/nntpdriver_cached.h
	install -m 0644 generic/nntpdriver_tools.h ${STAGING_DIR}/target/include/libetpan/nntpdriver_tools.h
	install -m 0644 generic/nntpdriver_message.h ${STAGING_DIR}/target/include/libetpan/nntpdriver_message.h
	install -m 0644 generic/nntpdriver_cached_message.h ${STAGING_DIR}/target/include/libetpan/nntpdriver_cached_message.h
	install -m 0644 generic/nntpstorage.h ${STAGING_DIR}/target/include/libetpan/nntpstorage.h
	install -m 0644 generic/nntpdriver_types.h ${STAGING_DIR}/target/include/libetpan/nntpdriver_types.h
	install -m 0644 generic/pop3driver.h ${STAGING_DIR}/target/include/libetpan/pop3driver.h
	install -m 0644 generic/pop3driver_cached.h ${STAGING_DIR}/target/include/libetpan/pop3driver_cached.h
	install -m 0644 generic/pop3driver_message.h ${STAGING_DIR}/target/include/libetpan/pop3driver_message.h
	install -m 0644 generic/pop3driver_cached_message.h ${STAGING_DIR}/target/include/libetpan/pop3driver_cached_message.h
	install -m 0644 generic/pop3storage.h ${STAGING_DIR}/target/include/libetpan/pop3storage.h
	install -m 0644 generic/pop3driver_types.h ${STAGING_DIR}/target/include/libetpan/pop3driver_types.h
	install -m 0644 generic/mboxdriver.h ${STAGING_DIR}/target/include/libetpan/mboxdriver.h
	install -m 0644 generic/mboxdriver_cached.h ${STAGING_DIR}/target/include/libetpan/mboxdriver_cached.h
	install -m 0644 generic/mboxdriver_message.h ${STAGING_DIR}/target/include/libetpan/mboxdriver_message.h
	install -m 0644 generic/mboxdriver_cached_message.h ${STAGING_DIR}/target/include/libetpan/mboxdriver_cached_message.h
	install -m 0644 generic/mboxstorage.h ${STAGING_DIR}/target/include/libetpan/mboxstorage.h
	install -m 0644 generic/mboxdriver_types.h ${STAGING_DIR}/target/include/libetpan/mboxdriver_types.h
	install -m 0644 generic/mhdriver.h ${STAGING_DIR}/target/include/libetpan/mhdriver.h
	install -m 0644 generic/mhdriver_cached.h ${STAGING_DIR}/target/include/libetpan/mhdriver_cached.h
	install -m 0644 generic/mhdriver_message.h ${STAGING_DIR}/target/include/libetpan/mhdriver_message.h
	install -m 0644 generic/mhdriver_cached_message.h ${STAGING_DIR}/target/include/libetpan/mhdriver_cached_message.h
	install -m 0644 generic/mhstorage.h ${STAGING_DIR}/target/include/libetpan/mhstorage.h
	install -m 0644 generic/mhdriver_types.h ${STAGING_DIR}/target/include/libetpan/mhdriver_types.h
	install -m 0644 generic/maildirdriver.h ${STAGING_DIR}/target/include/libetpan/maildirdriver.h
	install -m 0644 generic/maildirdriver_message.h ${STAGING_DIR}/target/include/libetpan/maildirdriver_message.h
	install -m 0644 generic/maildirdriver_cached.h ${STAGING_DIR}/target/include/libetpan/maildirdriver_cached.h
	install -m 0644 generic/maildirdriver_cached_message.h ${STAGING_DIR}/target/include/libetpan/maildirdriver_cached_message.h
	install -m 0644 generic/maildirdriver_types.h ${STAGING_DIR}/target/include/libetpan/maildirdriver_types.h
	install -m 0644 generic/maildirstorage.h ${STAGING_DIR}/target/include/libetpan/maildirstorage.h
	install -m 0644 generic/data_message_driver.h ${STAGING_DIR}/target/include/libetpan/data_message_driver.h
	install -m 0644 generic/mime_message_driver.h ${STAGING_DIR}/target/include/libetpan/mime_message_driver.h
	install -m 0644 generic/mailthread.h ${STAGING_DIR}/target/include/libetpan/mailthread.h
	install -m 0644 generic/mailthread_types.h ${STAGING_DIR}/target/include/libetpan/mailthread_types.h
	install -m 0644 generic/mailmessage.h ${STAGING_DIR}/target/include/libetpan/mailmessage.h
	install -m 0644 generic/mailmessage_types.h ${STAGING_DIR}/target/include/libetpan/mailmessage_types.h
	install -m 0644 generic/generic_cache.h ${STAGING_DIR}/target/include/libetpan/generic_cache.h
	install -m 0644 generic/mailmessage_tools.h ${STAGING_DIR}/target/include/libetpan/mailmessage_tools.h
	install -m 0644 generic/maildriver_tools.h ${STAGING_DIR}/target/include/libetpan/maildriver_tools.h
	install -m 0644 generic/mailstorage.h ${STAGING_DIR}/target/include/libetpan/mailstorage.h
	install -m 0644 generic/mailstorage_types.h ${STAGING_DIR}/target/include/libetpan/mailstorage_types.h
	install -m 0644 generic/libetpan.h ${STAGING_DIR}/target/include/libetpan/libetpan.h
}

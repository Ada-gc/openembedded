
#
# Patch managed by http://www.holgerschurig.de/patcher.html
#

--- xine-lib-1-rc7/src/libvorbis/xine_decoder.c~libxine-libvorbis.patch
+++ xine-lib-1-rc7/src/libvorbis/xine_decoder.c
@@ -40,7 +40,7 @@
 #include "buffer.h"
 
 #include <ogg/ogg.h>
-#include <vorbis/codec.h>
+#include <tremor/ivorbiscodec.h>
 
 #define MAX_NUM_SAMPLES 4096
 
@@ -215,7 +215,7 @@
  
   } else if (this->output_open) {
 
-    float **pcm;
+    int **pcm;
     int samples;
 
     if(vorbis_synthesis(&this->vb,&this->op,1)==0) 
@@ -244,9 +244,9 @@
 	 interleave */
       for(i=0;i<this->vi.channels;i++){
 	ogg_int16_t *ptr=audio_buffer->mem+i;
-	float  *mono=pcm[i];
+	int  *mono=pcm[i];
 	for(j=0;j<bout;j++){
-	  int val=mono[j]*32767.f;
+	  int val=mono[j]>>9;
 	  /* might as well guard against clipping */
 	  if(val>32767){
 	    val=32767;

From 4e7a9d05d31c0228f315656d730dfda205bd8530 Mon Sep 17 00:00:00 2001
From: Mans Rullgard <mans@mansr.com>
Date: Wed, 3 Nov 2010 19:52:52 +0000
Subject: [PATCH 7/8] omap4: enable L2 prefetching

Signed-off-by: Mans Rullgard <mans@mansr.com>
---
 arch/arm/mach-omap2/omap4-common.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-omap2/omap4-common.c b/arch/arm/mach-omap2/omap4-common.c
index d01bf1a..0fedc6a 100644
--- a/arch/arm/mach-omap2/omap4-common.c
+++ b/arch/arm/mach-omap2/omap4-common.c
@@ -57,6 +57,9 @@ static int __init omap_l2_cache_init(void)
 	l2cache_base = ioremap(OMAP44XX_L2CACHE_BASE, SZ_4K);
 	BUG_ON(!l2cache_base);
 
+	if (omap_rev() == OMAP4430_REV_ES2_0)
+		omap_smc1(0x109, 0x7e470000);
+
 	/* Enable PL310 L2 Cache controller */
 	omap_smc1(0x102, 0x1);
 
@@ -65,7 +68,7 @@ static int __init omap_l2_cache_init(void)
 	 * parity disabled
 	 */
 	if (omap_rev() == OMAP4430_REV_ES2_0)
-		l2x0_init(l2cache_base, 0x0e070000, 0xc0000fff);
+		l2x0_init(l2cache_base, 0x7e470000, 0xc0000fff);
 	else
 		l2x0_init(l2cache_base, 0x0e050000, 0xc0000fff);
 
-- 
1.6.6.1


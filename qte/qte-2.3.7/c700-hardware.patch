
#
# Patch managed by http://www.mn-logistik.de/unsupported/pxa250/patcher
#

--- qt-2.3.7/src/kernel/qwindowsystem_qws.cpp~c700-hardware	2003-07-17 03:20:26.000000000 +0200
+++ qt-2.3.7/src/kernel/qwindowsystem_qws.cpp	2004-06-29 15:42:57.000000000 +0200
@@ -126,7 +126,7 @@
 static QRect maxwindow_rect;
 extern Q_EXPORT QRect qt_maxWindowRect;
 static const char *defaultMouse =
-#if defined(QT_QWS_CASSIOPEIA) || defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX) || defined(QT_QWS_YOPY) || defined(QWS_CUSTOMTOUCHPANEL)
+#if defined(QT_QWS_CASSIOPEIA) || defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX) || defined(QT_QWS_SLC700) || defined(QT_QWS_YOPY) || defined(QWS_CUSTOMTOUCHPANEL)
     "TPanel"
 #else
     "Auto"
@@ -3067,7 +3067,7 @@
 void QWSServer::screenSaverSleep()
 {
     qt_screen->blank(TRUE);
-#if !defined(QT_QWS_IPAQ) && !defined(QT_QWS_SL5XXX)
+#if !defined(QT_QWS_IPAQ) && !defined(QT_QWS_SL5XXX) && !defined(QT_QWS_SLC700)
     d->screensavertimer->stop();
 #else
     if ( screensaverinterval ) {
--- qt-2.3.7/src/kernel/qwsmouse_qws.cpp~c700-hardware	2004-06-29 15:28:37.000000000 +0200
+++ qt-2.3.7/src/kernel/qwsmouse_qws.cpp	2004-06-29 15:44:04.000000000 +0200
@@ -97,6 +97,19 @@
 #define QT_QWS_TP_MOVE_LIMIT 50
 #define QT_QWS_TP_JITTER_LIMIT 2
 #endif
+#elif defined(QT_QWS_SLC700)
+#define QT_QWS_SLC700_RAW
+typedef struct {
+       unsigned short pressure;
+       unsigned short x;
+       unsigned short y;
+       unsigned short millisecs;
+} TS_EVENT;
+#define QT_QWS_TP_SAMPLE_SIZE 10
+#define QT_QWS_TP_MINIMUM_SAMPLES 4 
+#define QT_QWS_TP_PRESSURE_THRESHOLD 500 
+#define QT_QWS_TP_MOVE_LIMIT 50
+#define QT_QWS_TP_JITTER_LIMIT 2
 #endif
 
 #ifndef QT_QWS_TP_SAMPLE_SIZE
@@ -583,7 +596,7 @@
 	sub[nsub++] = new QAutoMouseSubHandler_intellimouse(fd);
 	notify(fd);
     }
-#if !defined(QT_QWS_IPAQ) && !defined(QT_QWS_SL5XXX)
+#if !defined(QT_QWS_IPAQ) && !defined(QT_QWS_SL5XXX) && !defined(QT_QWS_SLC700)
     char fn[] = "/dev/ttyS?";
     for (int ch='0'; ch<='3'; ch++) {
 	fn[9] = ch;
@@ -1459,7 +1472,7 @@
     : samples(QT_QWS_TP_SAMPLE_SIZE), currSample(0), lastSample(0),
     numSamples(0), skipCount(0)
 {
-#if defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX)
+#if defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX) || defined(QT_QWS_SLC700)
 #if defined(QT_QWS_IPAQ)
 # ifdef QT_QWS_IPAQ_RAW
     if ((mouseFD = open( "/dev/h3600_tsraw", O_RDONLY | O_NDELAY)) < 0) {
@@ -1469,7 +1482,7 @@
         qWarning( "Cannot open /dev/h3600_ts (%s)", strerror(errno));
 	return;
     }
-#elif defined(QT_QWS_SL5XXX)
+#elif defined(QT_QWS_SL5XXX) || defined(QT_QWS_SLC700)
 //# ifdef QT_QWS_SL5XXX_TSRAW
 # if 0
     if ((mouseFD = open( "/dev/tsraw", O_RDONLY | O_NDELAY)) < 0) {
@@ -1495,7 +1508,7 @@
 
 QTPanelHandlerPrivate::~QTPanelHandlerPrivate()
 {
-#if defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX)
+#if defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX) || defined(QT_QWS_SLC700)
     if (mouseFD >= 0)
 	close(mouseFD);
 #endif
@@ -1503,7 +1516,7 @@
 
 void QTPanelHandlerPrivate::readMouseData()
 {
-#if defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX)
+#if defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX) || defined(QT_QWS_SLC700)
     if(!qt_screen)
 	return;
 
@@ -1522,7 +1535,7 @@
 	uchar *mb = mouseBuf+idx;
 	data = (TS_EVENT *) mb;
 	if(data->pressure >= QT_QWS_TP_PRESSURE_THRESHOLD) {
-#ifdef QT_QWS_SL5XXX
+#if defined(QT_QWS_SL5XXX) || defined(QT_QWS_SLC700)
 	    samples[currSample] = QPoint( 1000 - data->x, data->y );
 #else
 	    samples[currSample] = QPoint( data->x, data->y );
@@ -1541,7 +1554,7 @@
 
 		mousePos = totalMousePos / (sampleCount - 1);
 
-# if defined(QT_QWS_IPAQ_RAW) || defined(QT_QWS_SL5XXX_RAW)
+# if defined(QT_QWS_IPAQ_RAW) || defined(QT_QWS_SL5XXX_RAW) || defined(QT_QWS_SLC700_RAW)
 		mousePos = transform( mousePos );
 # endif
 		if(!waspressed)
@@ -1916,7 +1929,7 @@
 	    handler = new QCustomTPanelHandlerPrivate( mouseProtocol, mouseDev );
 #elif defined(QT_QWS_YOPY)
 	    handler = new QYopyTPanelHandlerPrivate( mouseProtocol, mouseDev );
-#elif defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX)
+#elif defined(QT_QWS_IPAQ) || defined(QT_QWS_SL5XXX) || defined(QT_QWS_SLC700)
 	    handler = new QTPanelHandlerPrivate( mouseProtocol, mouseDev );
 #elif defined(QT_QWS_CASSIOPEIA)
 	    handler = new QVrTPanelHandlerPrivate( mouseProtocol, mouseDev );

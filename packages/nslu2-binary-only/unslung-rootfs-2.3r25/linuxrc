#!/bin/sh

if [ -f /.useportmap ] ; then
    /sbin/portmap
fi
# /bin/umount /initrd

/bin/echo "Firmware Version: `/bin/cat /.unslung`"
/bin/mount -t proc proc /proc
/bin/echo "5" > /proc/sys/kernel/panic
/bin/sleep 1

#mounted=
#
#/bin/echo "0x1f04" > /proc/sys/kernel/real-root-dev
#
#/bin/umount /mnt/tmpmnt/proc
#/bin/umount /mnt/tmpmnt
#
#/bin/sleep 10
#
#if [ -z "$mounted" ] && /bin/mount -rt ext3 /dev/sda2 /mnt/tmpmnt ; then
#
#    if  [ -x /mnt/tmpmnt/bin/init ] &&
#	[ -d /mnt/tmpmnt/unslung ] && [ -r /mnt/tmpmnt/.unslung ] &&
#	[ "`/bin/cat /.unslung`" = "`/bin/cat /mnt/tmpmnt/.unslung`" ] ; then
#	/bin/echo "Root filesystem will be mounted from /dev/sda2 ..."
#	mounted=/mnt/tmpmnt
#	/bin/echo "0x0802" > /proc/sys/kernel/real-root-dev
#	[ -r $mounted/unslung/rc.linuxrc ] && . $mounted/unslung/rc.linuxrc
#    fi
#
#    /bin/umount /mnt/tmpmnt
#fi
#
#if [ -z "$mounted" ] && /bin/mount -rt ext3 /dev/sdb2 /mnt/tmpmnt ; then
#
#    if  [ -x /mnt/tmpmnt/bin/init ] &&
#	[ -d /mnt/tmpmnt/unslung ] && [ -r /mnt/tmpmnt/.unslung ] &&
#	[ "`/bin/cat /.unslung`" = "`/bin/cat /mnt/tmpmnt/.unslung`" ] ; then
#	/bin/echo "Root filesystem will be mounted from /dev/sdb2 ..."
#	mounted=/mnt/tmpmnt
#	/bin/echo "0x0812" > /proc/sys/kernel/real-root-dev
#	[ -r $mounted/unslung/rc.linuxrc ] && . $mounted/unslung/rc.linuxrc
#    fi
#
#    /bin/umount /mnt/tmpmnt
#fi
#
#if [ -z "$mounted" ] ; then
#    /bin/echo "Root filesystem will be mounted from /dev/ram0 ..."
#fi
#
/bin/umount /proc

exec /bin/init
exit 0

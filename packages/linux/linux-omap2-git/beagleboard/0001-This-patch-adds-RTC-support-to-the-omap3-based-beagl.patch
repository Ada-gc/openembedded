From 3f8441b4e1fc297caf5cf712c1bc3f506ec28065 Mon Sep 17 00:00:00 2001
From: Koen Kooi <koen@openembedded.org>
Date: Thu, 8 May 2008 18:30:41 +0200
Subject: [PATCH] This patch adds RTC support to the omap3 based beagleboard

Signed-off-by: Koen Kooi <koen@openembedded.org>
---
 arch/arm/mach-omap2/board-omap3beagle.c |   12 ++++++++++++
 1 files changed, 12 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-omap2/board-omap3beagle.c b/arch/arm/mach-omap2/board-omap3beagle.c
index 626f004..0c0cbfc 100644
--- a/arch/arm/mach-omap2/board-omap3beagle.c
+++ b/arch/arm/mach-omap2/board-omap3beagle.c
@@ -58,13 +58,25 @@ static struct omap_mmc_config omap3beagle_mmc_config __initdata = {
 	},
 };
 
+static struct platform_device omap3_beagle_twl4030rtc_device = {
+	.name           = "twl4030_rtc",
+	.id             = -1,
+};
+
 static struct omap_board_config_kernel omap3_beagle_config[] __initdata = {
 	{ OMAP_TAG_UART,	&omap3_beagle_uart_config },
 	{ OMAP_TAG_MMC,		&omap3beagle_mmc_config },
 };
 
+static struct platform_device *omap3_beagle_devices[] __initdata = {
+#ifdef CONFIG_RTC_DRV_TWL4030
+	&omap3_beagle_twl4030rtc_device,
+#endif
+};
+
 static void __init omap3_beagle_init(void)
 {
+	platform_add_devices(omap3_beagle_devices, ARRAY_SIZE(omap3_beagle_devices));
 	omap_board_config = omap3_beagle_config;
 	omap_board_config_size = ARRAY_SIZE(omap3_beagle_config);
 	omap_serial_init();
-- 
1.5.4.3


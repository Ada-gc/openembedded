Index: zlib-1.2.3/configure
===================================================================
--- zlib-1.2.3.orig/configure	2005-07-11 22:11:57.000000000 +0200
+++ zlib-1.2.3/configure	2006-08-06 20:22:47.000000000 +0200
@@ -35,6 +35,7 @@
 gcc=0
 old_cc="$CC"
 old_cflags="$CFLAGS"
+target=`(uname -s || echo unknown) 2>/dev/null`
 
 while test $# -ge 1
 do
@@ -42,7 +43,7 @@
     -h* | --h*)
       echo 'usage:'
       echo '  configure [--shared] [--prefix=PREFIX]  [--exec_prefix=EXPREFIX]'
-      echo '     [--libdir=LIBDIR] [--includedir=INCLUDEDIR]'
+      echo '     [--libdir=LIBDIR] [--includedir=INCLUDEDIR] [--target=TARGET]'
         exit 0;;
     -p*=* | --p*=*) prefix=`echo $1 | sed 's/[-a-z_]*=//'`; shift;;
     -e*=* | --e*=*) exec_prefix=`echo $1 | sed 's/[-a-z_]*=//'`; shift;;
@@ -53,6 +54,7 @@
     -l* | --l*) libdir="$2"; shift; shift;;
     -i* | --i*) includedir="$2"; shift; shift;;
     -s* | --s*) shared=1; shift;;
+    --target=*) target=`echo $1 | sed 's/[-a-z_]*=//'`;shift;;
     *) echo "unknown option: $1"; echo "$0 --help for help"; exit 1;;
     esac
 done
@@ -75,7 +77,7 @@
   CC="$cc"
   SFLAGS=${CFLAGS-"-fPIC -O3"}
   CFLAGS="$cflags"
-  case `(uname -s || echo unknown) 2>/dev/null` in
+  case $target in
   Linux | linux | GNU | GNU/*) LDSHARED=${LDSHARED-"$cc -shared -Wl,-soname,libz.so.1"};;
   CYGWIN* | Cygwin* | cygwin* | OS/2* )
              EXE='.exe';;

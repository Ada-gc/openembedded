--- gaim/configure.ac	2006-02-09 00:04:40.000000000 +0100
+++ gaim/configure.ac	2006-02-09 22:37:00.000000000 +0100
@@ -111,6 +111,14 @@
 AC_CHECK_FUNC(dlopen, LIBDL="", [AC_CHECK_LIB(dl, dlopen, LIBDL="-ldl")])
 
 AC_MSG_CHECKING(for the %z format string in strftime())
+
+if test "x$gaim_cv_HAVE_STRFTIME_Z_FORMAT" = "xyes"; then
+	AC_MSG_RESULT(yes)
+	AC_DEFINE([HAVE_STRFTIME_Z_FORMAT], [1],
+                                      [Define to 1 if you have a strftime() that supports the %z format string.])
+elif test "x$gaim_cv_HAVE_STRFTIME_Z_FORMAT" = "xno"; then
+	AC_MSG_RESULT(no)
+else
 AC_TRY_RUN([
 #ifdef HAVE_SYS_TIME_H
 #include <sys/time.h>
@@ -145,6 +153,7 @@
 	AC_MSG_RESULT(no)
 ]
 )
+fi
 
 
 dnl #######################################################################
